# Next.js 첫걸음

25.03.03 ~

## 개발 환경 세팅

1. 설치

```
npx create-next-app@latest
```

혹은

```
yarn create next-app .
```

❗️왜 yarn은 @latest 를 안붙이지?
yarn create 자체가 최신 버전을 자동으로 가져오기 때문에 따로 명시하지 않아도 된다.

_역시 yarn.._

2. 실행

```
yarn dev
```

react vite와는 다르게 yarn 설치 필요없이
바로 yarn dev로 로컬호스트3000번 포트가 열린다.

## 정적 라우팅

버전 15.2.0 기준(13버전과 동일)

1. src/app폴더 안에
2. router(경로)명으로 사용할 이름을 폴더명으로 지정
3. 그 안에 파일을 추가한다.

> ❗️반드시 파일명을 page 지정해줘야 적용된다.
> <br />
> 경로: http://localhost:3000/폴더명

> ➕ 중첩 라우팅을 하고 싶다면?
> <br />
> 폴더 안에 폴더를 추가하고 그 안에 page 파일을 생성하면 된다.
> <br />
> 경로: http://localhost:3000/폴더명/폴더명

## 동적 라우팅

1. src/app폴더 안에
2. router(경로)명으로 사용할 이름을 폴더명으로 지정
3. 그 안에 폴더를 추가해주는데 이게 리액트에서 동적라우팅할 때의 /:id 이 부분이다.
   해당 폴더명을 []대괄호로 감싸고 그 안에 page.tsx 파일을 추가한다.
4. products/하위의 어떤 이름을 입력해도 [slug]폴더 하위의 page.tsx가 화면에 보여진다.

> ❗️동적라우팅 폴더명은 [id], [item] 등 어떤걸 해도 상관없으나 통상적으로 [slug]를 많이 사용한다.

### 정적 매개변수 생성

동적 라우팅은 로딩이 좀 걸리므로
미리 페이지명 몇가지를 지정해서 일부 동적페이지도 미리 생성되게 처리할 수 있다.
generateStaticParams 라고 Next에서 지정한 함수명을 사용한다.

> ❓ 무슨차이냐

1. 동적인 페이지라서 렌더링 시 HTML 생성(동적라우팅이라서 어떤 페이지명이 들어올지 모르기 때문에 미리 준비해두지 않은 상태)

```tsx
type Props = {
  params: {
    slug: string;
  };
};
const DynamicRouter = ({ params }: Props) => {
  return <div>{params.slug} 제품설명페이지</div>;
};
export default DynamicRouter;
```

2. 렌더링 시간을 줄이기 위해 미리 특정 페이지명을 지정해두고 HTML을 빌드할 때 미리 만들어두는 것(아래 예시는 "pants", "skirt"경로에 한해서 미리 생성)

```tsx
// 정적 매개변수 생성
// 이 기능은 동적 경로 세그먼트generateStaticParams 와 함께 사용하여
// 요청 시점에 주문형으로 생성하는 대신 빌드 시점에 정적으로 경로를 생성
export async function generateStaticParams() {
  const products = ["pants", "skirt"];

  return products.map((product) => ({
    slug: product,
  }));
}
```

> #### ❗️ 동적라우팅의 정적매개변수 생성 이런 방식도 가능해요.
>
> [...slug] 뒤에 오는 배열까지 전부 미리 생성

> #### ❗️ 대괄호가 둘로 묶여있으면 [[...slug]] 있어도 되고 없어도 되는 옵셔널의 의미

## not-found.js

1. src/app폴더 안에
2. not-found 라는 파일명으로 된 파일을 하나 만든다.
3. 13.3 버전 이후에는 글로벌하게 일치하지 않는 URL을 자동처리해준다.
   Home 컴포넌트에서 notFound(); 호출하고 경로 지정해주는 것은 불필요해짐.

## layout.js

### 방법:

1. src/app폴더 안에
2. layout 라는 파일이 있는데 그 페이지의 xml 부분을 건들면 된다.

> ❓ 모든 페이지에서가 아닌 특정 페이지의 하위에서만 보여지는
> 특정 헤더가 필요하다면
> 해당 폴더(경로)안에 layout.tsx 파일을 생성해주면 된다.

예시1)
경로 src/app/layout.tsx

```tsx
import type { Metadata } from "next";
import { Geist, Geist_Mono } from "next/font/google";
import "./globals.css";

const geistSans = Geist({
  variable: "--font-geist-sans",
  subsets: ["latin"],
});

const geistMono = Geist_Mono({
  variable: "--font-geist-mono",
  subsets: ["latin"],
});

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <body
        className={`${geistSans.variable} ${geistMono.variable} antialiased`}
      >
        <header>
          <h1>헤더</h1>
          <nav>
            <a href="">contact</a>
            <a href="">etc</a>
          </nav>
        </header>
        {children}
      </body>
    </html>
  );
}
```

예시2)
경로 src/app/products/layout.tsx

```tsx
import "../globals.css";

export default function ProductsLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <>
      <nav className="products-nav">
        <a href="">pants</a>
        <a href="">skirt</a>
      </nav>
      <section>{children}</section>
    </>
  );
}
```

## Link

반드시 a 태그가 아닌 Link 태그를 사용해줘야 한다고 한다.(a 태그 써도 잘 돌아가긴 함)

예시1)
경로 src/app/layout.tsx

```tsx
<body className={`${geistSans.variable} ${geistMono.variable} antialiased`}>
  <header>
    <h1>헤더</h1>
    <nav>
      <Link href="/products">Products</Link>
      <Link href="/contact">Contact</Link>
      <Link href="/about">About</Link>
    </nav>
  </header>
  {children}
</body>
```

> ❗️ 반드시 a 태그가 아닌 Link 태그를 사용해줘야 한다고 한다.(a 태그 써도 잘 돌아가긴 함)

예시2)
경로 src/app/products/page.tsx

```tsx
import Link from "next/link";

const products = ["shirt", "pants", "skirt", "shose"];

const ProductsPage = () => {
  return (
    <>
      <h1>제품소개페이지</h1>
      <ul className="products-item-nav">
        {products.map((product, index) => (
          <li key={index}>
            <Link href={`products/${product}`}>{product}</Link>
          </li>
        ))}
      </ul>
    </>
  );
};

export default ProductsPage;
```
